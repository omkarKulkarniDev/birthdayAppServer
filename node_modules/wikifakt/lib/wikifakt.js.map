{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 85941fef8649b53090a5","webpack:///./src/index.js","webpack:///external \"request\"","webpack:///external \"cheerio\"","webpack:///external \"bluebird\""],"names":[],"mappings":"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","file":"wikifakt.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"request\"), require(\"cheerio\"), require(\"bluebird\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"wikifakt\", [\"request\", \"cheerio\", \"bluebird\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"wikifakt\"] = factory(require(\"request\"), require(\"cheerio\"), require(\"bluebird\"));\n\telse\n\t\troot[\"wikifakt\"] = factory(root[\"request\"], root[\"cheerio\"], root[\"bluebird\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 85941fef8649b53090a5\n **/","import request from 'request';\nimport cheerio from 'cheerio';\nimport Promise from 'bluebird';\n\nconst WIKI_RANDOM = 'https://en.wikipedia.org/wiki/Special:Random';\nconst WIKI_API = 'https://en.wikipedia.org/w/api.php?format=json&action=query&prop=extracts&exintro=&explaintext=&titles=';\n\nexport default {\n    factLengthLimit: 200,\n    preload: true,\n    preloadedFact: '',\n\n    getRandomFact: function(preloading = false) {\n        return new Promise((resolve, reject) => {\n            let sentFact = false;\n            if (this.preload && this.preloadedFact !== '') {\n                sentFact = true;\n                resolve(this.preloadedFact);\n                this.preloadedFact = '';\n            }\n\n            this.getRandomArticleTitle().then((articleTitle) => {\n                let titleQuery = articleTitle.split(' ').join('%20');\n                request(WIKI_API + titleQuery, (error, response, body) => {\n                    if (!error && response.statusCode === 200 && body !== '') {\n                        let json = JSON.parse(body);\n                        let keys = Object.keys(json.query.pages);\n                        if (keys.length === 0) {\n                            return this.getRandomFact();\n                        } else {\n                            let page = json.query.pages[keys[0]];\n                            let fact = page.extract;\n                            if (!fact || fact === '') {\n                                this.getRandomFact(preloading).then((newFact) => {\n                                    resolve(newFact);\n                                });\n                            } else {\n                                if (fact.length > this.factLengthLimit) {\n                                    let factSplits = fact.split('.');\n                                    fact = factSplits[0] += '.';\n                                    if (fact.length < this.factLengthLimit && factSplits.length > 1) {\n                                        fact += factSplits[1] + '.';\n                                    }\n                                }\n\n                                // already returned a fact\n                                // save new fact in preload\n                                if (sentFact) {\n                                    this.preloadedFact = fact;\n                                } else {\n                                    resolve(fact);\n\n                                    // if we want to preload a fact for next time\n                                    // and we arent currently preloading one\n                                    // then get a new fact and cache it in preloadedFact field\n                                    if (!preloading && this.preload && this.preloadedFact === '') {\n                                        this.getRandomFact(true).then((newFact) => {\n                                            this.preloadedFact = newFact;\n                                        });\n                                    }\n                                }\n                            }\n                        }\n                    } else {\n                        if (!sentFact) {\n                            // there was an error fetching from wikipedia api\n                            // just try again\n                            this.getRandomFact(preloading).then((fact) => {\n                                resolve(fact);\n                            });\n                        }\n                    }\n                });\n            });\n        });\n    },\n\n    getRandomArticleTitle: function() {\n        return new Promise((resolve, reject) => {\n            request(WIKI_RANDOM, (error, response, body) => {\n                if (!error && response.statusCode === 200) {\n                    let $ = cheerio.load(body);\n                    let articleTitle = $('#firstHeading').text();\n                    resolve(articleTitle);\n                } else {\n                    reject(error);\n                }\n            });\n        });\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/index.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"request\"\n ** module id = 1\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"cheerio\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"bluebird\"\n ** module id = 3\n ** module chunks = 0\n **/"],"sourceRoot":""}